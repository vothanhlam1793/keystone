(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{495:function(e,t,s){"use strict";s.d(t,"a",(function(){return f}));var a=s(5),i=s(6),n=s(7),l=s(1),r=s(91),c=s(312),o=s(121),u=s(13),d=(s(475),s(0));const b=Object(d.forwardRef)(({data:e,loading:t,value:s,refList:c,canRead:b,isMulti:f,search:m,autoFocus:j,serverErrors:g,onChange:h,htmlID:p,setSearch:O,selectProps:y,fetchMore:v,isDisabled:x},N)=>{const $=e&&e[c.gqlNames.listQueryName]?e[c.gqlNames.listQueryName].map(e=>({value:e,label:e._label_})):[],D=g&&g.find(e=>e instanceof Error&&"AccessDeniedError"===e.name);let k=null;const C=e=>"string"==typeof e?$.find(t=>t.value.id===e)||{label:e,value:e}:{label:e._label_,value:e};null!==s&&b&&(f?k=(Array.isArray(s)?s:[]).map(C):s&&(k=C(s)));const M=e&&e[c.gqlNames.listQueryMetaName]?e[c.gqlNames.listQueryMetaName].count:0,R=Object(d.useMemo)(()=>({MenuList:e=>{let{children:t}=e,s=Object(n.a)(e,["children"]);const a=Object(d.useRef)(null),o=r.d`
            query RelationshipSelectMore($search: String!, $first: Int!, $skip: Int!) {
              ${c.gqlNames.listQueryName}(search: $search, first: $first, skip: $skip) {
                _label_
                id
              }
            }
          `;return function(e,t){Object(d.useEffect)(()=>{let s=new IntersectionObserver(e,{}),a=t.current;if(null!==a)return s.observe(a),()=>s.unobserve(a)})}(([{isIntersecting:e}])=>{!s.isLoading&&e&&s.options.length<M&&v({query:o,variables:{search:m,first:50,skip:s.options.length},updateQuery:(e,{fetchMoreResult:t})=>t?Object(i.a)(Object(i.a)({},e),{},{[c.gqlNames.listQueryName]:[...e[c.gqlNames.listQueryName],...t[c.gqlNames.listQueryName]]}):e})},a),Object(l.jsx)(u.f.MenuList,s,t,Object(l.jsx)("div",{css:{textAlign:"center"},ref:a},s.options.length<M&&Object(l.jsx)("span",{css:{padding:8}},"Loading...")))}}),[M,c.gqlNames.listQueryName]);return Object(l.jsx)(o.a,Object(a.a)({onInputChange:e=>O(e),isLoading:t,autoFocus:j,isMulti:f,components:R,getOptionValue:e=>e.value.id,value:k,placeholder:b?void 0:D&&D.message,options:$,onChange:h,id:"react-select-"+p,isClearable:!0,instanceId:p,inputId:p,innerRef:N,menuPortalTarget:document.body,isDisabled:x},y))}),f=({innerRef:e,autoFocus:t,field:s,errors:a,renderContext:i,htmlID:n,onChange:o,isMulti:u,value:f,isDisabled:m})=>{const[j,g]=Object(d.useState)(""),h=s.getRefList(),p=r.d`
    query RelationshipSelect($search: String!, $first: Int!, $skip: Int!) {
      ${h.gqlNames.listQueryName}(search: $search, first: $first, skip: $skip) {
        _label_
        id
      }

      ${h.gqlNames.listQueryMetaName}(search: $search) {
        count
      }
    }
  `,O=!a||a.every(e=>!(e instanceof Error&&"AccessDeniedError"===e.name)),y="dialog"===i?{menuShouldBlockScroll:!0}:null,{data:v,error:x,loading:N,fetchMore:$}=Object(c.a)(p,{fetchPolicy:"network-only",variables:{search:j,first:10,skip:0}});return x?(console.log("ERROR!!!",x),"Error"):Object(l.jsx)(b,{data:v,loading:N,value:f,refList:h,canRead:O,isMulti:u,search:j,autoFocus:t,serverErrors:a,onChange:o,htmlID:n,setSearch:g,selectProps:y,fetchMore:$,ref:e,isDisabled:m})}},698:function(e,t,s){"use strict";s.r(t);var a=s(6),i=s(1),n=s(0),l=s(312),r=s(91),c=s(87),o=s(9),u=s(2),d=s(8),b=s(66),f=s(495),m=s(219);s(169),s(168),s(121),s(475);function j({listKey:e,value:t,onAddUser:s,many:a,isDisabled:n}){const c="authenticated"+e,{data:f}=Object(l.a)(r.d`
    query User {
      ${c} {
        _label_
        id
      }
    }
  `);if(f&&f[c]){const e=f[c].id;if(null!==t&&(a?t.some(t=>t.id===e):t.id===e))return null;const l=`${a?"Add":"Set as"} ${f[c]._label_}`;return Object(i.jsx)(b.a,{placement:"top",content:l},e=>Object(i.jsx)(d.b,{css:{marginLeft:u.d},variant:"ghost",ref:e,onClick:()=>{s(f[c])},icon:o.r,"aria-label":l,isDisabled:n}))}return null}function g({field:e,value:t}){const{many:s}=e.config,{fullPath:a}=e.getRefList();let n,l=!1,r=a;return s?(n="View List of Related Items",t.length||(l=!0),r=`${r}?!id_in="${t.slice(0,100).map(({id:e})=>e).join(",")}"`):(n="View Item Details",t?r=`${r}/${t.id}`:l=!0),Object(i.jsx)(b.a,{placement:"top",content:n},e=>Object(i.jsx)(d.b,{ref:e,icon:o.m,"aria-label":n,variant:"ghost",css:{marginLeft:u.d},target:"_blank",to:r,isDisabled:l}))}function h({field:e,item:t,onCreate:s,isDisabled:l}){const{list:r,openCreateItemModal:c}=Object(m.e)();let f,j=e.getRefList(),g="Create and add "+j.singular;return t&&t.id&&(f=j.fields.filter(t=>"Relationship"===t.type&&t.config.ref===r.key&&t.config.refFieldPath===e.path).reduce((e,s)=>{const i={_label_:t._label_||"<link to parent>",id:t.id};return Object(a.a)(Object(a.a)({},e),{},{[s.path]:s.config.many?[i]:i})},{})),Object(i.jsx)(n.Fragment,null,Object(i.jsx)(b.a,{placement:"top",content:g},e=>Object(i.jsx)(d.b,{ref:e,onClick:c,icon:o.s,"aria-label":g,variant:"ghost",css:{marginLeft:u.d},isDisabled:l})),Object(i.jsx)(m.a,{prefillData:f,onCreate:({data:e})=>{s(e[j.gqlNames.createMutationName])}}))}t.default=({autoFocus:e,field:t,value:s=[],renderContext:a,errors:n,onChange:l,item:r,list:o,isDisabled:u})=>{const{many:d,ref:b}=t.config,{authStrategy:p}=Object(m.d)(),O="ks-input-"+t.path,y=t.getRefList();return Object(i.jsx)(c.a,null,Object(i.jsx)(c.d,{htmlFor:O,field:t,errors:n}),Object(i.jsx)(c.b,{text:t.adminDoc}),Object(i.jsx)(c.c,null,Object(i.jsx)("div",{css:{flex:1}},Object(i.jsx)(f.a,{autoFocus:e,isMulti:d,field:t,value:s,errors:n,renderContext:a,htmlID:O,onChange:e=>{const{many:s}=t.config;l(s?e?e.map(e=>e.value):[]:e?e.value:null)},isDisabled:u})),Object(i.jsx)(m.b,{list:y},Object(i.jsx)(h,{onCreate:e=>{l(d?s.concat(e):e)},field:t,item:r,list:o,isDisabled:u})),p&&b===p.listKey&&Object(i.jsx)(j,{many:d,onAddUser:e=>{l(d?s.concat(e):e)},value:s,listKey:p.listKey,isDisabled:u}),Object(i.jsx)(g,{field:t,value:s})))}}}]);
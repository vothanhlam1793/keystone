
<script>
    var CHANGE_PASSWORD = `
    mutation changePassword($token: String!, $password: String!) {
        changePasswordWithToken(token: $token, password: $password){
            id
        }
    }
    `;
    var opt = new Vue({
        el: "#otp",
        data: {
            code: "",
            password: "",
            step: 1
        },
        methods: {
            otp: function(){
                console.log(this.code);
                if(this.code.length != 6){
                    return alert("OTP có 6 chữ số");
                }
                this.step = 2;
            },
            changePass: function(){
                if(this.password.length < 8){
                    return alert("Mật khẩu phải có ít nhất 8 kí tự");
                }
                graphql(CHANGE_PASSWORD, {
                    token: this.code,
                    password: this.password
                }).then(a => {
                    if(!a.data.changePasswordWithToken){
                        console.log("Reset thất bại");
                    } else {
                        location.href="/user/login";
                        console.log("Reset thành công");
                    }
                })
            }
        }
    })
</script>